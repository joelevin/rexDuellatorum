package {	import flash.events.MouseEvent;	import flash.display.MovieClip;	import flash.events.*;	import flash.display.Stage;	import flash.ui.Keyboard;	import TheGame;	import flash.text.Font;	import flash.display.Bitmap;	import flash.display.BitmapData;	import flash.display.Sprite;	public class Init extends MovieClip	{		//var bgBitmapData:BitmapData = new BitmapData(960, 640, false, 0x333333);		//var bg:Bitmap = new Bitmap(bgBitmapData);		var bg:Sprite = new Sprite();		var start_btn:StartBtn = new StartBtn();		var instructions_btn:Instructions = new Instructions();		var mainMenu:MainMenu = new MainMenu();		var instructionsTitle:InstructionsTitle = new InstructionsTitle();		var title:Title= new Title();		var instructionTxt: InstructionTXT= new InstructionTXT();		var startTheGame:WorldMap;		var stageRef:Stage;		var intro:IntroMovie=new IntroMovie();		var skipTheIntro:SkipIntro = new SkipIntro();		var totalFrame:Number = intro.totalFrames;		var curFrame:Number;		var quadratisFont:Font = new Quadratis();		var enchantedFont:Font = new Enchanted();		//var introPlayed:Boolean = false;		//var stageRef:Canvas = new Canvas();		public function Init()		{			addEventListener(Event.ADDED_TO_STAGE, addedToStageHandler);		}		function theMainMenu()		{			title.x = bg.width / 2;			title.y = 100;			start_btn.x = bg.width / 2 - (start_btn.width/2);			instructions_btn.x = start_btn.x;			start_btn.y = bg.height - 150;			instructions_btn.y = start_btn.y + 55;			bg.addChild(title);			bg.addChild(start_btn);			bg.addChild(instructions_btn);			start_btn.buttonMode = true;			instructions_btn.buttonMode = true;			start_btn.addEventListener(MouseEvent.CLICK, startGame);			instructions_btn.addEventListener(MouseEvent.CLICK, showInstructions);		}		function startGame(e:MouseEvent):void		{			title.visible = false;			start_btn.visible = false;			instructions_btn.visible = false;			instructionsTitle.visible = false;			instructionTxt.visible = false;			mainMenu.visible = false;			trace("start game");			startTheGame = new WorldMap(stageRef, bg);			bg.addChild(startTheGame);		}		function playIntro()		{			skipTheIntro.x = stageRef.stageWidth - 200;			skipTheIntro.y = stageRef.stageHeight - 50;			bg.addChild(intro);			bg.addChild(skipTheIntro);			stageRef.addEventListener(KeyboardEvent.KEY_DOWN, skipIntro);			intro.addEventListener(Event.EXIT_FRAME, removeIntroHandler);			intro.gotoAndPlay(1);		}				function skipIntro(e:KeyboardEvent):void		{			if(e.keyCode == Keyboard.ENTER)			{				trace("intro being skipped?");				intro.stop();				bg.removeChild(skipTheIntro);				bg.removeChild(intro);				stageRef.removeEventListener(KeyboardEvent.KEY_DOWN, skipIntro);			}			theMainMenu();		}		function removeIntroHandler(e:Event):void		{			curFrame = intro.currentFrame;			if (totalFrame==curFrame)			{				intro.stop();				//introPlayed = true;				bg.removeChild(intro);				bg.removeChild(skipTheIntro);				intro.removeEventListener(Event.EXIT_FRAME, removeIntroHandler);				stageRef.removeEventListener(KeyboardEvent.KEY_DOWN, skipIntro);				theMainMenu();			}		}		function addedToStageHandler(e:Event):void		{			stageRef = stage;			drawBackground();			stageRef.addChild(bg);			//if (! introPlayed)			//{				playIntro();			/*}			else			{				theMainMenu();			}*/		}				function drawBackground():void		{			bg.graphics.beginFill(0x333333);			bg.graphics.drawRect(0, 0, 960, 640);			bg.graphics.endFill();		}		function showInstructions(e:MouseEvent):void		{			bg.removeChild(title);			bg.removeChild(instructions_btn);			mainMenu.x = stageRef.stageWidth / 2 - 200;			mainMenu.y = stageRef.stageHeight - 100;			instructionsTitle.x = 500;			instructionsTitle.y = 100;			start_btn.x = mainMenu.x + 205;			start_btn.y = stageRef.stageHeight - 100;			instructionTxt.x = stage.stageWidth / 2;			instructionTxt.y = stage.stageHeight / 2;			bg.addChild(instructionsTitle);			bg.addChild(instructionTxt);			bg.addChild(mainMenu);			mainMenu.buttonMode = true;			mainMenu.addEventListener(MouseEvent.CLICK, backToMain);			start_btn.addEventListener(MouseEvent.CLICK, startGame);		}		function backToMain(e:MouseEvent):void		{			bg.removeChild(instructionsTitle);			bg.removeChild(instructionTxt);			bg.removeChild(mainMenu);			theMainMenu();		}	}}